{"version":3,"file":"ngx-gapi-auth2.umd.js","sources":["../../src/lib/config/google-api.config.ts","../../src/lib/models/auth.ts","../../src/lib/services/google-api-loader.service.ts","../../src/lib/services/google-auth2-loader.service.ts","../../src/lib/services/google-auth.service.ts","../../src/lib/common-util-google-oauth.module.ts","../../src/ngx-gapi-auth2.ts"],"sourcesContent":["export interface NgGapiClientConfig {\n\n  /**\n   * User for mocking auth flow to local storage save\n   */\n  e2e: boolean;\n\n  /**\n   * The app's client ID, found and created in the Google Developers Console.\n   */\n  client_id: string;\n\n  /**\n   * The domains for which to create sign-in cookies. Either a URI, single_host_origin, or none.\n   * Defaults to single_host_origin if unspecified.\n   */\n  cookie_policy?: string;\n\n  /**\n   * The scopes to request, as a space-delimited string. Optional if fetch_basic_profile is not set to false.\n   */\n  scope?: string;\n\n  /**\n   * Fetch users' basic profile information when they sign in. Adds 'profile' and 'email' to the requested scopes. True if unspecified.\n   */\n  fetch_basic_profile?: boolean;\n\n  /**\n   * The Google Apps domain to which users must belong to sign in. This is susceptible to modification by clients,\n   * so be sure to verify the hosted domain property of the returned user. Use GoogleUser.getHostedDomain() on the client,\n   * and the hd claim in the ID Token on the server to verify the domain is what you expected.\n   */\n  hosted_domain?: string;\n\n  /**\n   * The UX mode to use for the sign-in flow.\n   * By default, it will open the consent flow in a popup.\n   */\n  ux_mode?: 'popup' | 'redirect';\n\n  /**\n   * If using ux_mode='redirect', this parameter allows you to override the default redirect_uri that will be used at the end of the consent flow.\n   * The default redirect_uri is the current URL stripped of query parameters and hash fragment.\n   */\n  redirect_uri?: string;\n}\n\nexport class GoogleApiConfig {\n  protected clientConfig: NgGapiClientConfig;\n  protected mocked: boolean;\n\n  constructor(config: NgGapiClientConfig) {\n    this.clientConfig = config;\n    this.mocked = config.e2e;\n  }\n\n  public getMocked(): boolean {\n    return this.mocked;\n  }\n\n  public getClientConfig(): NgGapiClientConfig {\n    return this.clientConfig;\n  }\n}\n","export class AuthData {\n  constructor(\n    public id: string,\n    public firstName: string,\n    public lastName: string,\n    public email: string,\n    public avatar: string,\n    public idToken: string,\n    public tokenExpiresAt: number\n  ) { }\n}\n\nexport interface SignInError {\n  type: 'cookiesNotEnabled' | string;\n}\n\nexport interface TokenError {\n  idpId: 'google' | string;\n  type: 'tokenFailed' | 'userLoggedOut' | 'noSessionBound' | string;\n  error?: string;\n}\n","import { Inject, Injectable, InjectionToken } from '@angular/core';\nimport { Observable, Observer } from 'rxjs';\nimport { GoogleApiConfig, NgGapiClientConfig } from '../config/google-api.config';\n\nexport let NG_GAPI_CONFIG: InjectionToken<NgGapiClientConfig> =\n  new InjectionToken<NgGapiClientConfig>('ng-gapi.config');\n\n@Injectable()\nexport class GoogleApiLoaderService {\n  private readonly gapiUrl: string = 'https://apis.google.com/js/platform.js';\n  private readonly config: GoogleApiConfig;\n\n  constructor(@Inject(NG_GAPI_CONFIG) config: NgGapiClientConfig) {\n    this.config = new GoogleApiConfig(config);\n    this.loadGapi().subscribe();\n  }\n\n  public onLoad(): Observable<boolean> {\n    return this.loadGapi();\n  }\n\n  public getConfig(): GoogleApiConfig {\n    return this.config;\n  }\n\n  public isMocked(): boolean {\n    return this.config.getMocked();\n  }\n\n  private loadGapi(): Observable<boolean> {\n    return new Observable((observer: Observer<boolean>) => {\n      const node = document.createElement('script');\n      node.src = this.gapiUrl;\n      node.type = 'text/javascript';\n      document.getElementsByTagName('head')[0].appendChild(node);\n      node.onload = () => {\n        observer.next(true);\n        observer.complete();\n      };\n    });\n  }\n}\n","/// <reference types=\"gapi.auth2\" />\nimport { Injectable } from '@angular/core';\nimport { Observable, Observer, of } from 'rxjs';\nimport { mergeMap } from 'rxjs/operators';\n\nimport GoogleAuth = gapi.auth2.GoogleAuth;\nimport { GoogleApiLoaderService } from './google-api-loader.service';\n\n\n@Injectable()\nexport class GoogleAuth2LoaderService {\n  private GoogleAuth: GoogleAuth = undefined;\n\n  constructor(private googleApi: GoogleApiLoaderService) {\n    this.googleApi.onLoad().subscribe(() => {\n      this.loadGoogleAuth2().subscribe();\n    });\n  }\n\n  public getAuth(newInstance = false): Observable<GoogleAuth> {\n    if (!this.GoogleAuth || newInstance) {\n      return this.googleApi.onLoad()\n        .pipe(mergeMap(() => this.loadGoogleAuth2()));\n    }\n    return of(this.GoogleAuth);\n  }\n\n  private loadGoogleAuth2(): Observable<GoogleAuth> {\n    return new Observable((observer: Observer<GoogleAuth>) => {\n      gapi.load('auth2', () => {\n        gapi.auth2.init(this.googleApi.getConfig().getClientConfig()).then((auth: GoogleAuth) => {\n          this.GoogleAuth = auth;\n          observer.next(auth);\n          observer.complete();\n        }).catch((err: any) => observer.error(err));\n      });\n    });\n  }\n}\n","import { Injectable, NgZone } from '@angular/core';\nimport { interval, Observable, ReplaySubject } from 'rxjs';\nimport { tap } from 'rxjs/operators';\n\n\nimport { GoogleAuth2LoaderService } from './google-auth2-loader.service';\nimport { GoogleApiLoaderService } from './google-api-loader.service';\nimport { AuthData, SignInError } from '../models/auth';\n\n@Injectable()\nexport class GoogleAuthService {\n  private _authState: ReplaySubject<AuthData> = new ReplaySubject(1);\n  private _loginState: ReplaySubject<AuthData | SignInError> = new ReplaySubject(1);\n  private auth: gapi.auth2.GoogleAuth;\n\n  private readonly SIGN_IN_EXPIRE_KEY = 'loginExpirationDate';\n\n  get authState(): Observable<AuthData> {\n    return this._authState.asObservable();\n  }\n\n  get loginState(): Observable<AuthData | SignInError> {\n    return this._loginState.asObservable();\n  }\n\n  constructor(\n    private googleAuth2LoaderService: GoogleAuth2LoaderService,\n    private googleApiLoaderService: GoogleApiLoaderService,\n    private ngZone: NgZone\n  ) {\n    if (this.googleApiLoaderService.isMocked()) {\n      this.signIn();\n    } else {\n      this.googleApiLoaderService.onLoad().subscribe(() => {\n        this.googleAuth2LoaderService.getAuth().subscribe(\n          auth => this.authLoaded(auth),\n          () => this.removeState()\n        );\n        interval(20 * 60 * 1000).pipe(  // run every 20min\n          tap(() => this.refreshToken())\n        ).subscribe();\n      });\n    }\n  }\n\n  public signIn(): void {\n    if (this.googleApiLoaderService.isMocked()) {\n      this._loginState.next(JSON.parse(localStorage.getItem('user')));\n      this._authState.next(JSON.parse(localStorage.getItem('user')));\n    } else {\n      const now = new Date();\n      const expirationDate = this.setTime(now, null, now.getMinutes() + 5);\n      localStorage.setItem(this.SIGN_IN_EXPIRE_KEY, expirationDate.toISOString());\n      const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n      this.auth.signIn({\n        prompt: 'select_account',\n        ux_mode: isSafari ? 'popup' : 'redirect',\n      }).then(() => this.fetchLoginData());\n    }\n  }\n\n  public signOut(): void {\n    if (!this.googleApiLoaderService.isMocked()) {\n      this.auth.signOut();\n    }\n    this.removeState();\n  }\n\n  public fetchLoginData(): Promise<void> {\n    return this.auth.currentUser.get().reloadAuthResponse().then(r => {\n      this.ngZone.run(() => {\n        this._loginState.next(this.getProfile(r.id_token, r.expires_at));\n        this._authState.next(this.getProfile(r.id_token, r.expires_at));\n      });\n    });\n  }\n\n  public refreshToken(): Promise<void> {\n    return this.auth.currentUser.get().reloadAuthResponse().then(r => {\n      this.ngZone.run(() => this._authState.next(this.getProfile(r.id_token, r.expires_at)));\n    });\n  }\n\n  private authLoaded(auth: gapi.auth2.GoogleAuth): void {\n    this.auth = auth;\n    if (this.auth.currentUser.get().isSignedIn()) {\n      this.fetchLoginData();\n      localStorage.removeItem(this.SIGN_IN_EXPIRE_KEY);\n    } else {\n      const signInDateExpireDate = new Date(localStorage.getItem(this.SIGN_IN_EXPIRE_KEY));\n      if (signInDateExpireDate > new Date()) {\n        this._loginState.next({ type: 'cookiesNotEnabled' });\n        this._authState.next(null);\n      } else {\n        this.removeState();\n      }\n    }\n  }\n\n  private removeState(): void {\n    this._authState.next(null);\n    this._loginState.next(null);\n  }\n\n  private getProfile(token: string, expiresAt: number): AuthData {\n    const p = this.auth.currentUser.get().getBasicProfile();\n    return p ? {\n      id: p.getId(),\n      email: p.getEmail(),\n      firstName: p.getGivenName(),\n      lastName: p.getFamilyName(),\n      avatar: p.getImageUrl(),\n      idToken: token,\n      tokenExpiresAt: expiresAt,\n    } : null;\n  }\n\n  private setTime(date: string | Date, hours?: number, minutes?: number, seconds?: number, milliseconds?: number): Date {\n    const newDate = new Date(date);\n    if (typeof hours === 'number') {\n      newDate.setHours(hours);\n    }\n    if (typeof minutes === 'number') {\n      newDate.setMinutes(minutes);\n    }\n    if (typeof seconds === 'number') {\n      newDate.setSeconds(seconds);\n    }\n    if (typeof milliseconds === 'number') {\n      newDate.setMilliseconds(milliseconds);\n    }\n    return newDate;\n  }\n}\n","import { ModuleWithProviders, NgModule, Provider } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { GoogleApiLoaderService } from './services/google-api-loader.service';\nimport { GoogleAuth2LoaderService } from './services/google-auth2-loader.service';\nimport { GoogleAuthService } from './services/google-auth.service';\n\n@NgModule({\n  imports: [CommonModule]\n})\nexport class GoogleOauthModule {\n  static forRoot(gapiConfigProvider: Provider): ModuleWithProviders<GoogleOauthModule> {\n    return {\n      ngModule: GoogleOauthModule,\n      providers: [\n        gapiConfigProvider,\n        GoogleApiLoaderService,\n        GoogleAuth2LoaderService,\n        GoogleAuthService\n      ]\n    };\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["InjectionToken","Observable","Injectable","Inject","mergeMap","of","ReplaySubject","interval","tap","CommonModule","NgModule"],"mappings":"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"}